# TextFlow 要件定義書

**バージョン**: 1.0  
**作成日**: 2026-01-13  
**最終更新日**: 2026-01-13

---

## 1. プロジェクト概要

### 1.1 プロジェクト名
**TextFlow（テキストフロー）**

### 1.2 目的
テキスト処理作業（文字数カウント、差分比較、履歴管理）を一つのプラットフォームで完結させる Webアプリケーション。

### 1.3 ビジョン
- 個人ユーザーからビジネスユーザーまで幅広い層に対応
- 広告収益と有料プランによる収益化
- シンプルで直感的なUI/UX

### 1.4 ターゲットユーザー

| ユーザー層 | 主な用途 |
|-----------|---------|
| 学生 | レポート作成、文字数確認 |
| ライター・ブロガー | 記事執筆、SEO対策 |
| エンジニア | コード比較、ドキュメント管理 |
| ビジネスパーソン | 契約書の変更確認、文書管理 |

---

## 2. 技術スタック

### 2.1 バックエンド
- **言語**: Java 17+
- **フレームワーク**: Spring Boot 3.x
- **セキュリティ**: Spring Security
- **ビルドツール**: Maven

### 2.2 フロントエンド
- **言語**: TypeScript
- **フレームワーク**: React 18+ (Vite)
- **スタイリング**: Tailwind CSS
- **国際化**: react-i18next
- **状態管理**: React Context / Zustand

### 2.3 データベース
- **開発環境**: Docker Compose + PostgreSQL 15+
- **本番環境**: Neon / Railway PostgreSQL

### 2.4 ホスティング
- **フロントエンド**: Vercel
- **バックエンド**: Render / Railway
- **CI/CD**: GitHub Actions

### 2.5 決済（Phase 2）
- **決済サービス**: Stripe
- **対応**: サブスクリプション（月額/年額）

---

## 3. 機能要件

### 3.1 Phase 1（MVP）機能

#### 3.1.1 文字数カウント機能

| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| F001 | テキスト入力 | 複数行テキストエリア（最大100,000文字） | 高 |
| F002 | リアルタイムカウント | 入力中に即座に反映（50ms以内） | 高 |
| F003 | ファイルアップロード | .txt, .md ファイル対応（最大5MB） | 中 |
| F004 | カウント表示 | 総文字数、バイト数、行数、単語数、段落数 | 高 |
| F005 | SNS文字数 | Twitter/X(140字)、Instagram(2,200字)換算 | 中 |
| F006 | 原稿用紙換算 | 400字詰め原稿用紙枚数 | 中 |
| F007 | コピー機能 | ワンクリックでカウント結果・テキストをコピー | 高 |

**カウント項目詳細:**
- 総文字数（空白含む）
- 総文字数（空白なし）
- バイト数（UTF-8）
- 行数
- 単語数（英語）
- 段落数
- 原稿用紙換算（400字詰め）
- SNS文字数（Twitter/X: 140字、Instagram: 2,200字）

#### 3.1.2 テキスト差分比較機能

| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| F008 | 2カラム入力 | 左右2カラムのテキストエリア | 高 |
| F009 | ファイルアップロード | .txt, .md 対応、ドラッグ&ドロップ | 中 |
| F010 | 差分表示 | 追加(緑)、削除(赤)、変更(黄)をハイライト | 高 |
| F011 | 表示切替 | Side-by-side / Unified 表示 | 中 |
| F012 | 差分統計 | 追加行数、削除行数、変更行数、変更率 | 高 |
| F013 | 行番号表示 | 各行に行番号を表示 | 中 |

**差分処理方式:**
- **クライアント側処理**（Web Worker使用）
- ライブラリ: `diff-match-patch` または `jsdiff`
- 10,000行まで5秒以内に処理

#### 3.1.3 履歴機能

| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| F014 | ゲスト履歴 | localStorage保存、最大5件 | 高 |
| F015 | 認証ユーザー履歴 | DB保存、無制限 | 高 |
| F016 | 自動保存 | テキスト編集時に自動保存 | 中 |
| F017 | タイトル編集 | デフォルト: 最初の30文字 | 中 |
| F018 | 履歴一覧 | サイドバーに表示、検索・削除可能 | 高 |
| F019 | 履歴復元 | クリックで復元 | 高 |
| F020 | 自動移行 | ログイン時にlocalStorage→DB自動移行 | 高 |

#### 3.1.4 ユーザー認証

| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| F021 | ゲストモード | 登録不要で基本機能利用可能 | 高 |
| F022 | ユーザー登録 | メールアドレス + パスワード | 高 |
| F023 | ログイン | メール + パスワード認証 | 高 |
| F024 | パスワードリセット | メール送信によるリセット | 中 |
| F025 | プロフィール管理 | ユーザー名、メール変更 | 低 |

> **Note:** OAuth2連携（Google/GitHub）はPhase 2に延期

#### 3.1.5 UI/UX機能

| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| F026 | 国際化(i18n) | 日本語・英語対応 | 高 |
| F027 | 言語切替 | ヘッダーから言語変更可能 | 高 |
| F028 | ダークモード | システム設定連動 + 手動切替 | 高 |
| F029 | レスポンシブ | モバイル・タブレット対応 | 高 |

---

### 3.2 Phase 2 機能

| 機能ID | 機能名 | 説明 | 優先度 |
|--------|--------|------|--------|
| F030 | OAuth2認証 | Google/GitHub連携 | 中 |
| F031 | 有料プラン | Stripe決済、月額500円/年額5,000円 | 中 |
| F032 | 広告非表示 | 有料ユーザー向け | 中 |
| F033 | AI改善提案 | 冗長表現検出、誤字脱字指摘 | 中 |
| F034 | SEO分析 | キーワード密度、見出し構造 | 低 |
| F035 | 共有リンク | 閲覧専用リンク生成 | 低 |
| F036 | PDFエクスポート | テキスト・差分のPDF出力 | 低 |

---

## 4. 非機能要件

### 4.1 パフォーマンス

| 項目 | 要件 |
|------|------|
| ページ読み込み | 2秒以内 |
| リアルタイムカウント | 50ms以内の応答 |
| 差分比較 | 10,000行まで5秒以内（クライアント側） |
| 同時接続 | 100ユーザーまで（MVP） |

### 4.2 セキュリティ

| 項目 | 対策 |
|------|------|
| 通信 | HTTPS必須 |
| CSRF | Spring Securityのデフォルト機能 |
| XSS | 入力値のサニタイズ |
| SQLインジェクション | Prepared Statement使用 |
| パスワード | BCryptハッシュ化 |
| セッション | タイムアウト30分 |
| ファイルアップロード | サイズ制限5MB、MIME Type検証 |

### 4.3 可用性

| 項目 | 要件 |
|------|------|
| 稼働率 | 99%以上（月間） |
| メンテナンス | 深夜2時〜4時（日本時間） |
| バックアップ | 毎日自動実行 |

### 4.4 ユーザビリティ

| 項目 | 要件 |
|------|------|
| レスポンシブ | モバイル完全対応 |
| ブラウザ | Chrome, Firefox, Safari, Edge（最新版） |
| アクセシビリティ | WCAG 2.1 Level AA準拠 |
| 多言語 | 日本語・英語（Phase 1から対応） |

### 4.5 保守性

| 項目 | 要件 |
|------|------|
| コーディング規約 | Google Java Style Guide、Airbnb JS Style Guide |
| テストカバレッジ | 70%以上 |
| APIドキュメント | Swagger/OpenAPI |
| ログ | INFO/WARN/ERROR出力 |

---

## 5. 収益化戦略

### 5.1 フリープラン
- 履歴保存: 5件まで（localStorage）
- 広告表示あり
- 基本機能利用可能

### 5.2 プレミアムプラン（Phase 2）
- 月額500円 / 年額5,000円
- 履歴保存: 無制限
- クラウド同期
- 広告非表示
- AI機能利用可能
- PDFエクスポート

### 5.3 広告収益
- Google AdSense
- 配置: サイドバー、コンテンツ下部
- 目標: 月10万PVで月2万円

---

## 6. 成功指標（KPI）

### 6.1 短期目標（3ヶ月）
- 月間ユーザー数: 1,000人
- 月間ページビュー: 10,000PV
- ユーザー登録数: 100人

### 6.2 中期目標（6ヶ月）
- 月間ユーザー数: 10,000人
- 有料プラン契約: 20件（月1万円）
- 広告収益: 月2万円

### 6.3 長期目標（1年）
- 月間ユーザー数: 50,000人
- 有料プラン契約: 100件（月5万円）
- 広告収益: 月10万円
- **合計収益: 月15万円**

---

## 7. 制約事項

### 7.1 技術的制約
- ファイルアップロード: テキストファイルのみ（.txt, .md）
- ファイルサイズ: 最大5MB
- テキスト長: 最大100,000文字

### 7.2 法的要件
- プライバシーポリシー作成必須
- 利用規約作成必須
- 個人情報保護法対応

---

## 8. 用語集

| 用語 | 説明 |
|------|------|
| MVP | Minimum Viable Product（最小限の実用製品） |
| i18n | Internationalization（国際化） |
| OAuth2 | 認証プロトコル |
| Web Worker | バックグラウンドでJavaScriptを実行する仕組み |
| localStorage | ブラウザのローカルストレージ |

---

## 変更履歴

| バージョン | 日付 | 変更内容 |
|-----------|------|---------|
| 1.0 | 2026-01-13 | 初版作成 |
